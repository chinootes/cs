{"pageProps":{"note":{"id":"jik03wh5g5jxxfz2aklbmub","title":"Multithreading","desc":"","updated":1727377517780,"created":1713121358159,"custom":{},"fname":"lang.java.concurrency.multithreading","type":"note","vault":{"fsPath":".","selfContained":true,"name":"cs"},"contentHash":"10572d0d17b573e50e34c8d09f92d914","links":[{"type":"wiki","from":{"fname":"lang.java.concurrency.multithreading","id":"jik03wh5g5jxxfz2aklbmub","vaultName":"cs"},"value":"lang.java.lib.multithreading","position":{"start":{"line":2,"column":24,"offset":24},"end":{"line":2,"column":56,"offset":56},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"lang.java.lib.multithreading"}},{"type":"wiki","from":{"fname":"lang.java.concurrency.multithreading","id":"jik03wh5g5jxxfz2aklbmub","vaultName":"cs"},"value":"execution.scheduling.pre-emptive","position":{"start":{"line":41,"column":6,"offset":802},"end":{"line":41,"column":42,"offset":838},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"execution.scheduling.pre-emptive"}},{"type":"wiki","from":{"fname":"lang.java.concurrency.multithreading","id":"jik03wh5g5jxxfz2aklbmub","vaultName":"cs"},"value":"execution.scheduling.time slicing","position":{"start":{"line":41,"column":47,"offset":843},"end":{"line":41,"column":84,"offset":880},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"execution.scheduling.time slicing"}},{"type":"wiki","from":{"fname":"lang.java.concurrency.multithreading","id":"jik03wh5g5jxxfz2aklbmub","vaultName":"cs"},"value":"lang.java.lib.multithreading.executor service","position":{"start":{"line":45,"column":12,"offset":910},"end":{"line":45,"column":61,"offset":959},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"lang.java.lib.multithreading.executor service"}},{"type":"wiki","from":{"fname":"lang.java.concurrency.multithreading","id":"jik03wh5g5jxxfz2aklbmub","vaultName":"cs"},"value":"lang.java.lib.collection","alias":"BlockingQueue","position":{"start":{"line":50,"column":91,"offset":1221},"end":{"line":50,"column":156,"offset":1286},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"lang.java.lib.collection","anchorHeader":"concurrent-collections"}},{"type":"wiki","from":{"fname":"lang.java.concurrency.multithreading","id":"jik03wh5g5jxxfz2aklbmub","vaultName":"cs"},"value":"lang.java.lib.classes.runtime","position":{"start":{"line":58,"column":9,"offset":1786},"end":{"line":58,"column":42,"offset":1819},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"lang.java.lib.classes.runtime"}}],"anchors":{"threads":{"type":"header","text":"Threads","value":"threads","line":15,"column":0,"depth":2},"life-cycle":{"type":"header","text":"Life Cycle","value":"life-cycle","line":20,"column":0,"depth":3},"thread-scheduler":{"type":"header","text":"Thread Scheduler","value":"thread-scheduler","line":41,"column":0,"depth":2},"thread-pool":{"type":"header","text":"Thread Pool","value":"thread-pool","line":49,"column":0,"depth":3},"ideal-pool-size":{"type":"header","text":"Ideal Pool Size","value":"ideal-pool-size","line":58,"column":0,"depth":4},"types-of-pools":{"type":"header","text":"Types of Pools","value":"types-of-pools","line":74,"column":0,"depth":4},"references":{"type":"header","text":"References","value":"references","line":82,"column":0,"depth":2}},"children":["b17hq2sylq3mv2kmoh8dzuk","3uaj7ngwih7npv8vlfs7k6d"],"parent":"okpm48r31vhesqem480f5ag","data":{}},"body":"<h1 id=\"multithreading\">Multithreading<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#multithreading\"></a></h1>\n<p>Components involved in <a href=\"/cs/notes/2yvl1jdxsuy6584xzcm4759\">Multithreading</a> in Java:</p>\n<ul>\n<li>Threads</li>\n<li>Thread Scheduler</li>\n<li>Thead Pool</li>\n<li>Executor Service</li>\n</ul>\n<h2 id=\"threads\">Threads<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#threads\"></a></h2>\n<ul>\n<li>One Java thread corresponds to one CPU thread.</li>\n</ul>\n<h3 id=\"life-cycle\">Life Cycle<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#life-cycle\"></a></h3>\n<div class=\"mermaid\">\n  stateDiagram\n    state Thread{\n        Runnable \n        Running \n        Terminated\n    }\n    state BlockedCode{\n        NonRunnable \n    }\n\n    [*] --> Runnable\n    Runnable --> Running: start()\n    Running --> Terminated\n\n    Running --> NonRunnable: sleep, block on I/O, wait for lock, suspend, wait\n    NonRunnable --> Runnable: sleep done, I/O complete, lock available, resume, notify, notifyAll\n        \n</div>\n<h2 id=\"thread-scheduler\">Thread Scheduler<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#thread-scheduler\"></a></h2>\n<p>Task executes for a predefined slice of time and then re-enters pool of ready tasks.</p>\n<p>Next task decided based on priority and other factors.</p>\n<p>Uses <a href=\"/cs/notes/s0ti7wyyxprb9hwd2x80nv5\">Pre Emptive Scheduling</a> and <a href=\"/cs/notes/auea1u426q9q291f1tl6kui\">Time Slicing</a></p>\n<h3 id=\"thread-pool\">Thread Pool<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#thread-pool\"></a></h3>\n<p>If you use <a href=\"/cs/notes/9tn4qoat4ksb1kha3p77zhe\">ExecutorService</a> to initialize a thread pool.</p>\n<p><img src=\"/cs/assets/images/2024-09-26.png\" alt=\"Thread Pool\"></p>\n<ul>\n<li>Threads initialized will pick up tasks from the queue of tasks given to the executor service</li>\n<li>Since multiple threads are accessing this queue simultaneously, executor service uses a <a href=\"/cs/notes/dkdtvct3q6f8lggmoqrqf43#concurrent-collections\">BlockingQueue</a>.</li>\n</ul>\n<h4 id=\"ideal-pool-size\">Ideal Pool Size<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#ideal-pool-size\"></a></h4>\n<ul>\n<li>\n<p><strong>CPU Intensive tasks</strong>: Tasks which block the CPU cores. For example, intensive hashing or cryptographic algorithms. In such cases, if you have even thousands of tasks, the number of threads running at a time will be equal to the number of cores on your CPU. So if you have too many threads, CPU will simply keep rotating between all these tasks and won't be able to actually complete any of these quick. </p>\n<p>  In such cases, <strong>Ideal Pool Size = CPU Core count</strong></p>\n<p>  Use <a href=\"/cs/notes/mxbdf8srsgf09fejmjuvrvs\">Runtime</a> to get the core count and initialize executor service with that.</p>\n<p>  Other consideration: How many other applications (or executors/threads are running on the same CPU)\n</p>\n</li>\n<li>\n<p><strong>I/O Intensive tasks</strong>: Tasks which don't really need the CPU, like input/output from user, or calls to a remote service. In such cases, even if you create few threads, CPU will keep waiting for a response to come back, staying idle. </p>\n</li>\n</ul>\n<p>Ideal pool size will be higher in such cases.</p>\n<p>Exact number will depend on the rate of task submissions and average task wait time. Too many threads will increase memory consumption too.</p>\n<h4 id=\"types-of-pools\">Types of Pools<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#types-of-pools\"></a></h4>\n<ul>\n<li>FixedThreadPool</li>\n<li>CachedThreadPool</li>\n<li>ScheduledThreadPool</li>\n<li>SingleThreadedExecutor</li>\n</ul>\n<h2 id=\"references\">References<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#references\"></a></h2>\n<ul>\n<li><a href=\"https://www.youtube.com/playlist?list=PLhfHPmPYPPRk6yMrcbfafFGSbE2EPK_A6\">Java Concurrency - Defog Tech - YouTube Playlist</a></li>\n</ul>\n<hr>\n<strong>Children</strong>\n<ol>\n<li><a href=\"/cs/notes/b17hq2sylq3mv2kmoh8dzuk\">Deadlocks</a></li>\n<li><a href=\"/cs/notes/3uaj7ngwih7npv8vlfs7k6d\">Thread Safety</a></li>\n</ol>","noteIndex":{"id":"7ncn3al6mmutkhgoesulce9","title":"Computer Science","desc":"","updated":1715103618849,"created":1713296516553,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":".","selfContained":true,"name":"cs"},"contentHash":"36faf26c6be438d4aed355d72b55a110","links":[{"type":"wiki","from":{"fname":"root","id":"7ncn3al6mmutkhgoesulce9","vaultName":"cs"},"value":"arch","position":{"start":{"line":6,"column":3,"offset":105},"end":{"line":6,"column":11,"offset":113},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"arch"}},{"type":"wiki","from":{"fname":"root","id":"7ncn3al6mmutkhgoesulce9","vaultName":"cs"},"value":"paradigm","position":{"start":{"line":11,"column":3,"offset":159},"end":{"line":11,"column":15,"offset":171},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"paradigm"}}],"anchors":{"references":{"type":"header","text":"References","value":"references","line":23,"column":0,"depth":2}},"children":["0xgibr34qhbv1edksyoxakk","e5kuv5gcz6pdxrsakpf7eia","t246wcci6dy9lnof7l1os4l","71sipcgr0pdqyxnmntvx28w","5omh1zinw87le0eyms8g5mk","91er1wb2f5wmbdb5axx5r3r","9z7xt251y1nm9dy2exatukr","u712e7r8bk97hpg9h9j3m4f","xpf86eilma499o4ul566fk8","a1g6tjx0p6bp25v75262gp9","3pr5jo5c742vop6gnoe7c3k","stxoouqpk2rivotuvhjx4yz","g8tiwuotfnbfrbctwyfg8rc","jk63inaclv0ps5i7mktzmm2","5m1yclhdqeshe5szt0masfk","abgag3m7m74vmofvzyyt2fm"],"parent":null,"data":{},"body":"\n\nThese notes are arranged into the below topics:\n\n- AI (Sorry this is on the top, list is alphabetic)\n- [[arch]]\n- Data\n- Execution\n- Languages\n- Semantics\n- [[paradigm]]\n- Philosophy\n- Dev\n- Tools\n- Type Theory\n\n## References\n\n- Hierarchy inpiration - [Map of Computer Science](https://www.flickr.com/photos/95869671@N08/36231833334/in/photostream/lightbox/)"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true,"enableSelfContainedVaults":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":"dependencies/github.com/chinootes/math","remote":{"type":"git","url":"git@github.com:chinootes/math.git"},"selfContained":true,"name":"math"},{"fsPath":".","selfContained":true,"name":"cs"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"task","dateFormat":"y.MM.dd","addBehavior":"asOwnDomain","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"taskCompleteStatus":["done","x"],"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableFullHierarchyNoteTitle":false,"enablePersistentHistory":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Dendron","description":"Personal Knowledge Space"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"search","siteUrl":"https://chinootes.github.io","assetsPrefix":"/cs","duplicateNoteBehavior":{"action":"useVault","payload":["math","cs"]},"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true}